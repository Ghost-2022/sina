import{a as e,b as a,q as t,r as l,o as r,g as s,A as n,m as i,f as o,e as d,u as c,F as u,B as p,E as m,j as g}from"./vendor.3e1d1ca5.js";import{_ as h,b as f,a as b}from"./index.4bf88f5f.js";const v={class:"mr-3 rowSS",style:{"justify-content":"center","margin-top":"15px"}},x=p("查询"),y=p("详情"),C={class:"block columnCC mt-2"};var k=h({setup(p){let{proxy:h}=g(),k=e([]),w=t({keyword:"",startTime:"",createTime:"",id:""}),z=()=>{const e=Object.assign(t({}),{page:T,size:j});Object.keys(e).forEach((a=>{""!==e[a]&&null!==e[a]&&void 0!==e[a]||delete e[a]}));let a={url:"/api/v1/search-list",method:"get",data:e,isParams:!0,isAlertErrorMsg:!1};h.$axiosReq(a).then((e=>{var a,t;k.value=null==(a=e.data)?void 0:a.list,h.pageTotalMixin=null==(t=e.data)?void 0:t.total}))},{pageNum:T,pageSize:j,handleCurrentChange:E,handleSizeChange:M}=function(t){const l=e(1),r=e(10);return a((()=>{})),{pageNum:l,pageSize:r,handleCurrentChange:e=>{l.value=e,t()},handleSizeChange:e=>{r.value=e,t()}}}(z);const _=e=>{e&&2===e.length?(w.startTime=e[0],w.endTime=e[1]):(w.startTime="",w.endTime="")};a((()=>{z(),f.on("reloadErrorPage",(()=>{z()}))}));let S=null;const O=()=>{const e=Object.assign(w,{});let a={url:"/api/v1/sina-search",method:"post",data:e,isParams:!1,isAlertErrorMsg:!0};Object.keys(e).forEach((a=>{""!==e[a]&&null!==e[a]&&void 0!==e[a]||delete e[a]})),m({message:"开始下载",type:"success"}),h.$axiosReq(a).then((a=>{let{isDownloading:l,searchId:r}=a.data;l&&(S=setInterval((()=>{const a=Object.assign(t({}),{searchId:r});Object.keys(a).forEach((t=>{""!==a[t]&&null!==a[t]&&void 0!==a[t]||delete e[t]}));let l={url:"/api/v1/check-spider",method:"get",data:a,isParams:!0};h.$axiosReq(l).then((e=>{let{status:a}=e.data;a&&(m({message:"下载完成",type:"success"}),clearInterval(S))}))}),12e4))}))};let P=e=>{h.$router.push({name:"Detail",query:e})};return(e,a)=>{const t=l("el-input"),p=l("el-form-item"),m=l("el-date-picker"),g=l("el-button"),h=l("el-form"),f=l("el-table-column"),z=l("el-table"),S=l("el-pagination");return r(),s(u,null,[n("操作"),i("div",v,[n("条件搜索"),o(h,{ref:(e,a)=>{a.refsearchFormMixin=e},inline:!0,class:"demo-searchFormMixin ml-2"},{default:d((()=>[o(p,{"label-width":"0px",label:"",prop:"keyword","label-position":"left"},{default:d((()=>[o(t,{modelValue:c(w).keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>c(w).keyword=e),class:"widthPx-150",placeholder:"关键词"},null,8,["modelValue"])])),_:1}),o(p,{"label-width":"0px",label:"",prop:"createTime","label-position":"left"},{default:d((()=>[o(m,{modelValue:e.startEndArrMixin,"onUpdate:modelValue":a[1]||(a[1]=a=>e.startEndArrMixin=a),type:"datetimerange",onChange:_,class:"widthPx-350","range-separator":"-","value-format":"YYYY-MM-DD HH:mm:ss","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])),_:1}),n("查询按钮"),o(g,{onClick:O},{default:d((()=>[x])),_:1})])),_:1},512)]),n("表格和分页"),o(z,{id:"resetElementDialog",ref:(e,a)=>{a.refuserTable=e},height:`calc(100vh - ${c(b).delWindowHeight})`,size:"mini",border:"",data:c(k)},{default:d((()=>[o(f,{type:"selection",align:"center",width:"50"}),o(f,{align:"center",prop:"keyword",label:"关键字"}),o(f,{align:"center",prop:"startTime",label:"开始时间"}),o(f,{align:"center",prop:"endTime",label:"结束时间"}),n("点击操作"),o(f,{fixed:"right",align:"center",label:"操作"},{default:d((({row:e})=>[o(g,{type:"text",size:"small",onClick:a=>c(P)(e)},{default:d((()=>[y])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["height","data"]),n("分页"),i("div",C,[o(S,{"current-page":c(T),"page-sizes":[10,20,50,100],"page-size":c(j),layout:"total, sizes, prev, pager, next, jumper",total:e.pageTotalMixin,onSizeChange:c(M),onCurrentChange:c(E)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])],64)}}},[["__scopeId","data-v-72e1c1cd"]]);const w={class:"dashboard-container"},z={setup:e=>(e,a)=>(r(),s("div",w,[o(c(k))]))};export{z as default};
